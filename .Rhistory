### Eighth Bin
bin_90 <- stud_grade %>% filter(Variable >= 80) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_90,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("80-90")
##### Ninth bin
bin_low <- stud_grade %>% filter(Variable < 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_low,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Bin_Low")
# Tenth bin
bin_top <- stud_grade %>% filter(Variable > 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_top,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Bin_Top")
stud_grade <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Grade") %>% arrange(as.numeric(Variable))
range(as.numeric(stud_grade$Variable),na.rm = TRUE)
stud_grade$Variable <- as.numeric(stud_grade$Variable)
stud_grade <- grade_norm(stud_grade)
bin_20 <- stud_grade %>% filter(Variable < 20) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_20,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("< 20")
### Second Bin
bin_30 <- stud_grade %>% filter(Variable >= 20 & Variable < 30) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_30,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("20-30")
### Third Bin
bin_40 <- stud_grade %>% filter(Variable >= 30 & Variable < 40) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_40,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("30-40")
### Fourth Bin
bin_50 <- stud_grade %>% filter(Variable >= 40 & Variable < 50) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_50,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("40-50")
### Fifth Bin
bin_60 <- stud_grade %>% filter(Variable >= 50 & Variable < 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_60,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("50-60")
### Sixth Bin
bin_70 <- stud_grade %>% filter(Variable >= 60 & Variable < 70) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_70,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("60-70")
### Seventh Bin
bin_80 <- stud_grade %>% filter(Variable >= 70 & Variable < 80) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_80,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("70-80")
### Eighth Bin
bin_90 <- stud_grade %>% filter(Variable >= 80) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_90,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("80-90")
##### Ninth bin
bin_low <- stud_grade %>% filter(Variable < 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_low,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Bin_Low")
# Tenth bin
bin_top <- stud_grade %>% filter(Variable > 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_top,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Bin_Top")
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
Stud_disc$cou <- 1
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
stud_disc$cou <- 1
stud_disc_con <- stud_disc %>% group_by(ThirdTier) %>% summarise(Cou = sum(cou))
View(stud_disc_con)
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
stud_disc$cou <- 1
stud_disc_con <- stud_disc %>% group_by(ThirdTier) %>% summarise(Cou = sum(cou)) %>% arrange(desc(Cou))
View(stud_disc_con)
View(stud_disc_con)
View(stud_disc_con)
ggplot(data = stud_disc_con,aes(ThirdTier,Cou,color=ThirdTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Top Discipline Cases")
ggplot(data = stud_disc_con,aes(ThirdTier,Cou,color=ThirdTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Top Discipline Cases") + theme(axis.text.x = element_text(angle = 90))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normpop))
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numric(Variable)))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normpop))
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)))
View(school_act)
View(school_norm)
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normpop))
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)))
q5 <- ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
q5 <- ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normpop))
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm$Norm <- school_norm$Norm/sum(school_norm$Norm)
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_nomr %>% filter(Schoolnames != "JJAEP Dallas Co" )
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normpop))
school_norm$Norm <- school_norm$Norm/sum(school_norm$Norm)
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)))
ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
library(dplyr)
library(ggplot2)
library(dplyr)
library(ggplot2)
Indi_attend <- Desoto_New %>% filter(FirstTier == "Attendence") %>% group_by(StudentID) %>% summarise(Attend = sum(as.numeric(Variable))) # Looking only at the attendence data
range(Indi_attend$Attend)
mean(Indi_attend$Attend)
# Doing some visualisation
q1 <- ggplot(data=Indi_attend,aes(StudentID,Attend,group=1)) + geom_point() + geom_line()
q1 + theme(axis.text.x=element_text(angle=90,hjust=1))
attend_250 <- Indi_attend %>% filter(Attend > 250) %>% arrange(desc(Attend))
# Imputing function moved to the functions script
stud_consol <- Desoto_New %>% filter(StudentID %in% attend_250$StudentID[1:5])
stud_consol$Date <- as.character(stud_consol$Date)
stud_consol$Month <- format(as.Date(stud_consol$Date),"%B") # Making a new variable for Month
stud_consol$Day <- format(as.Date(stud_consol$Date),"%a")
# Doing aggregation with respect to the Tiers with the function
########### Hiding the function because it is not getting created when preview is done
stud_agg <- firstier(stud_consol) # Running the function for the consolidation of the cases
###################################################
# Need to convert the Month as per the academic year order
stud_agg$Month <- factor(stud_agg$Month,levels = c("August","September","October","November","December","January","February","March","April","May","June"))
# Plotting all the variables together
q2 <- ggplot(data=stud_agg,aes(Month,Var,color=FirstTier,group=1)) + geom_point() + geom_line() + facet_grid(FirstTier~StudentID,scales = "free")
q2 + theme(axis.text.x=element_text(angle=70,hjust=1))
Desoto_New %>% filter(StudentID %in% attend_250$StudentID[101:126]) %>% filter(FirstTier == "Attendence") %>% summarise(Totdis = sum(as.numeric(Variable),na.rm=TRUE))
Desoto_New %>% filter(StudentID %in% attend_250$StudentID[101:126]) %>% filter(FirstTier == "Discipline") %>% summarise(Totdis = sum(as.numeric(Variable),na.rm=TRUE))
Desoto_New %>% filter(StudentID %in% attend_250$StudentID[1:26]) %>% filter(FirstTier == "Attendence") %>% summarise(Totdis = sum(as.numeric(Variable),na.rm=TRUE))
Desoto_New %>% filter(StudentID %in% attend_250$StudentID[1:26]) %>% filter(FirstTier == "Discipline") %>% summarise(Totdis = sum(as.numeric(Variable),na.rm=TRUE))
bins <- c(1,20,20,40,40,60,60,80,80,100,100,150,150,200,200,300,300,400,400,500,500,600,600,700,700,800,800,900,900,1000,1000,1324)
########### hiding the function data
bindata <- binvals(bins,Indi_attend)
##########################
bindata$Bin <- factor(bindata$Bin,levels = c("bin_1_20","bin_20_40","bin_40_60","bin_60_80","bin_80_100","bin_100_150","bin_150_200","bin_200_300","bin_300_400","bin_400_500","bin_500_600","bin_600_700","bin_700_800","bin_800_900","bin_900_1000", "bin_1000_1324"))
q3 <- ggplot(data=bindata,aes(Bin,Value,color=Variable,group=1)) + geom_point() + geom_line() + facet_grid(Variable~.,scales = "free")
q3 + theme(axis.text.x=element_text(angle=70,hjust=1))
# JMJPFU
# 15-Nov-2016
attend_150 <- Indi_attend %>% filter(Attend > 150 & Attend <= 600) %>% arrange(desc(Attend))
attend150_data <- Desoto_New %>% filter(StudentID %in% attend_150$StudentID)
# Aggregating data
attend150_data$Date <- as.character(attend150_data$Date)
attend150_data$Month <- format(as.Date(attend150_data$Date),"%B") # Making a new variable for Month
attend150_data$Day <- format(as.Date(attend150_data$Date),"%a")
# Doing aggregation with respect to the Tiers with the function
########### Hiding function data ############
stud_agg <- firstier(attend150_data) # Running the function for the consolidation of the cases
########### Hiding the function ###########
# Need to convert the Month as per the academic year order
stud_agg$Month <- factor(stud_agg$Month,levels = c("August","September","October","November","December","January","February","March","April","May","June"))
# Filtering some cases
temp <- stud_agg %>% filter(FirstTier == "Discipline") %>% group_by(StudentID) %>% summarise(Var = sum(as.numeric(Var))) %>% arrange(desc(as.numeric(Var)))
stud_fil <- stud_agg %>% filter(StudentID %in% temp$StudentID[6:10])
# Visualising the filtered cases
q4 <- ggplot(data=stud_fil,aes(Month,Var,color=FirstTier,group=1)) + geom_point() + geom_line() + facet_grid(FirstTier~StudentID,scales = "free")
q4 + theme(axis.text.x=element_text(angle=70,hjust=1))
stud_grade <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Grade") %>% arrange(as.numeric(Variable))
range(as.numeric(stud_grade$Variable),na.rm = TRUE)
stud_grade$Variable <- as.numeric(stud_grade$Variable)
stud_grade <- grade_norm(stud_grade)
bin_20 <- stud_grade %>% filter(Variable < 20) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_20,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("< 20")
### Second Bin
bin_30 <- stud_grade %>% filter(Variable >= 20 & Variable < 30) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_30,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("20-30")
### Third Bin
bin_40 <- stud_grade %>% filter(Variable >= 30 & Variable < 40) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_40,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("30-40")
### Fourth Bin
bin_50 <- stud_grade %>% filter(Variable >= 40 & Variable < 50) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_50,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("40-50")
### Fifth Bin
bin_60 <- stud_grade %>% filter(Variable >= 50 & Variable < 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_60,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("50-60")
### Sixth Bin
bin_70 <- stud_grade %>% filter(Variable >= 60 & Variable < 70) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_70,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("60-70")
### Seventh Bin
bin_80 <- stud_grade %>% filter(Variable >= 70 & Variable < 80) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_80,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("70-80")
### Eighth Bin
bin_90 <- stud_grade %>% filter(Variable >= 80) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_90,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("80-90")
##### Ninth bin
bin_low <- stud_grade %>% filter(Variable < 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_low,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Bin_Low")
# Tenth bin
bin_top <- stud_grade %>% filter(Variable > 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_top,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Bin_Top")
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
stud_disc$cou <- 1
stud_disc_con <- stud_disc %>% group_by(ThirdTier) %>% summarise(Cou = sum(cou)) %>% arrange(desc(Cou))
ggplot(data = stud_disc_con,aes(ThirdTier,Cou,color=ThirdTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Top Discipline Cases") + theme(axis.text.x = element_text(angle = 90))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normpop))
school_norm$Norm <- school_norm$Norm/sum(school_norm$Norm)
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)))
ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data = stud_disc_con,aes(ThirdTier,Cou)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Top Discipline Cases") + theme(axis.text.x = element_text(angle = 90))
bins <- c(1,20,20,40,40,60,60,80,80,100,100,150,150,200,200,300,300,400,400,500,500,600,600,700,700,800,800,900,900,1000,1000,1324)
########### hiding the function data
bindata <- binvals(bins,Indi_attend)
##########################
binvals1 <- function(bins,Indi_attend){
bindata <- data.frame(matrix(nrow=0,ncol=3))
names(bindata) <- c("Value","Variable","Bin")
for(k in 1:16) {
i = (2*k)-1
j = i+1
bot = bins[i]
top = bins[j]
attend_bin <- Indi_attend %>% filter(Attend > bot & Attend <= top)
label <- paste0("bin","_",bot,"_",top)
disval <- Desoto_New %>% filter(StudentID %in% attend_bin$StudentID) %>% filter(FirstTier == "Discipline") %>% summarise(Value = sum(as.numeric(Variable),na.rm=TRUE))
disval$Variable <- "Discipline"
disval$Bin <- label
gradval <- Desoto_New %>% filter(StudentID %in% attend_bin$StudentID) %>% filter(FirstTier == "Grade") %>% summarise(Value = mean(as.numeric(Variable),na.rm=TRUE))
gradval$Variable <- "Grade"
gradval$Bin <- label
comb <- rbind(disval,gradval)
bindata <- rbind(bindata,comb)
}
bindata
}
bindata2 <- binvals1(bins,Indi_attend)
View(bindata2)
bindata$Bin <- factor(bindata$Bin,levels = c("bin_1_20","bin_20_40","bin_40_60","bin_60_80","bin_80_100","bin_100_150","bin_150_200","bin_200_300","bin_300_400","bin_400_500","bin_500_600","bin_600_700","bin_700_800","bin_800_900","bin_900_1000", "bin_1000_1324"))
bindata2$Bin <- factor(bindata2$Bin,levels = c("bin_1_20","bin_20_40","bin_40_60","bin_60_80","bin_80_100","bin_100_150","bin_150_200","bin_200_300","bin_300_400","bin_400_500","bin_500_600","bin_600_700","bin_700_800","bin_800_900","bin_900_1000", "bin_1000_1324"))
q3 <- ggplot(data=bindata,aes(Bin,Value,color=Variable,group=1)) + geom_point() + geom_line() + facet_grid(Variable~.,scales = "free")
q3 + theme(axis.text.x=element_text(angle=70,hjust=1))
q8 <- ggplot(data=bindata2,aes(Bin,Value,color=Variable,group=1)) + geom_point() + geom_line() + facet_grid(Variable~.,scales = "free")
q8 + theme(axis.text.x=element_text(angle=70,hjust=1))
# JMJPFU
# 15-Nov-2016
attend_150 <- Indi_attend %>% filter(Attend > 150 & Attend <= 600) %>% arrange(desc(Attend))
attend150_data <- Desoto_New %>% filter(StudentID %in% attend_150$StudentID)
# Aggregating data
attend150_data$Date <- as.character(attend150_data$Date)
attend150_data$Month <- format(as.Date(attend150_data$Date),"%B") # Making a new variable for Month
attend150_data$Day <- format(as.Date(attend150_data$Date),"%a")
# Doing aggregation with respect to the Tiers with the function
########### Hiding function data ############
stud_agg <- firstier(attend150_data) # Running the function for the consolidation of the cases
########### Hiding the function ###########
# Need to convert the Month as per the academic year order
stud_agg$Month <- factor(stud_agg$Month,levels = c("August","September","October","November","December","January","February","March","April","May","June"))
View(Adl_Stud_timeline)
library(dplyr)
library(ggplot2)
Indi_attend <- Desoto_New %>% filter(FirstTier == "Attendence") %>% group_by(StudentID) %>% summarise(Attend = sum(as.numeric(Variable))) # Looking only at the attendence data
range(Indi_attend$Attend)
mean(Indi_attend$Attend)
# Doing some visualisation
q1 <- ggplot(data=Indi_attend,aes(StudentID,Attend,group=1)) + geom_point() + geom_line()
q1 + theme(axis.text.x=element_text(angle=90,hjust=1))
attend_250 <- Indi_attend %>% filter(Attend > 250) %>% arrange(desc(Attend))
# Imputing function moved to the functions script
stud_consol <- Desoto_New %>% filter(StudentID %in% attend_250$StudentID[1:5])
stud_consol$Date <- as.character(stud_consol$Date)
stud_consol$Month <- format(as.Date(stud_consol$Date),"%B") # Making a new variable for Month
stud_consol$Day <- format(as.Date(stud_consol$Date),"%a")
# Doing aggregation with respect to the Tiers with the function
########### Hiding the function because it is not getting created when preview is done
stud_agg <- firstier(stud_consol) # Running the function for the consolidation of the cases
###################################################
# Need to convert the Month as per the academic year order
stud_agg$Month <- factor(stud_agg$Month,levels = c("August","September","October","November","December","January","February","March","April","May","June"))
# Plotting all the variables together
q2 <- ggplot(data=stud_agg,aes(Month,Var,color=FirstTier,group=1)) + geom_point() + geom_line() + facet_grid(FirstTier~StudentID,scales = "free")
q2 + theme(axis.text.x=element_text(angle=70,hjust=1))
Desoto_New %>% filter(StudentID %in% attend_250$StudentID[101:126]) %>% filter(FirstTier == "Attendence") %>% summarise(Totdis = sum(as.numeric(Variable),na.rm=TRUE))
Desoto_New %>% filter(StudentID %in% attend_250$StudentID[101:126]) %>% filter(FirstTier == "Discipline") %>% summarise(Totdis = sum(as.numeric(Variable),na.rm=TRUE))
Desoto_New %>% filter(StudentID %in% attend_250$StudentID[1:26]) %>% filter(FirstTier == "Attendence") %>% summarise(Totdis = sum(as.numeric(Variable),na.rm=TRUE))
Desoto_New %>% filter(StudentID %in% attend_250$StudentID[1:26]) %>% filter(FirstTier == "Discipline") %>% summarise(Totdis = sum(as.numeric(Variable),na.rm=TRUE))
bins <- c(1,20,20,40,40,60,60,80,80,100,100,150,150,200,200,300,300,400,400,500,500,600,600,700,700,800,800,900,900,1000,1000,1324)
bindata <- binvals(bins,Indi_attend)
bindata2 <- binvals1(bins,Indi_attend)
bindata$Bin <- factor(bindata$Bin,levels = c("bin_1_20","bin_20_40","bin_40_60","bin_60_80","bin_80_100","bin_100_150","bin_150_200","bin_200_300","bin_300_400","bin_400_500","bin_500_600","bin_600_700","bin_700_800","bin_800_900","bin_900_1000", "bin_1000_1324"))
bindata2$Bin <- factor(bindata2$Bin,levels = c("bin_1_20","bin_20_40","bin_40_60","bin_60_80","bin_80_100","bin_100_150","bin_150_200","bin_200_300","bin_300_400","bin_400_500","bin_500_600","bin_600_700","bin_700_800","bin_800_900","bin_900_1000", "bin_1000_1324"))
q3 <- ggplot(data=bindata,aes(Bin,Value,color=Variable,group=1)) + geom_point() + geom_line() + facet_grid(Variable~.,scales = "free")
q3 + theme(axis.text.x=element_text(angle=70,hjust=1))
q8 <- ggplot(data=bindata2,aes(Bin,Value,color=Variable,group=1)) + geom_point() + geom_line() + facet_grid(Variable~.,scales = "free")
q8 + theme(axis.text.x=element_text(angle=70,hjust=1))
# JMJPFU
# 15-Nov-2016
attend_150 <- Indi_attend %>% filter(Attend > 150 & Attend <= 600) %>% arrange(desc(Attend))
attend150_data <- Desoto_New %>% filter(StudentID %in% attend_150$StudentID)
# Aggregating data
attend150_data$Date <- as.character(attend150_data$Date)
attend150_data$Month <- format(as.Date(attend150_data$Date),"%B") # Making a new variable for Month
attend150_data$Day <- format(as.Date(attend150_data$Date),"%a")
# Doing aggregation with respect to the Tiers with the function
########### Hiding function data ############
stud_agg <- firstier(attend150_data) # Running the function for the consolidation of the cases
########### Hiding the function ###########
# Need to convert the Month as per the academic year order
stud_agg$Month <- factor(stud_agg$Month,levels = c("August","September","October","November","December","January","February","March","April","May","June"))
# Filtering some cases
temp <- stud_agg %>% filter(FirstTier == "Discipline") %>% group_by(StudentID) %>% summarise(Var = sum(as.numeric(Var))) %>% arrange(desc(as.numeric(Var)))
stud_fil <- stud_agg %>% filter(StudentID %in% temp$StudentID[6:10])
# Visualising the filtered cases
q4 <- ggplot(data=stud_fil,aes(Month,Var,color=FirstTier,group=1)) + geom_point() + geom_line() + facet_grid(FirstTier~StudentID,scales = "free")
q4 + theme(axis.text.x=element_text(angle=70,hjust=1))
stud_grade <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Grade") %>% arrange(as.numeric(Variable))
range(as.numeric(stud_grade$Variable),na.rm = TRUE)
stud_grade$Variable <- as.numeric(stud_grade$Variable)
stud_grade <- grade_norm(stud_grade)
bin_20 <- stud_grade %>% filter(Variable < 20) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_20,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("< 20")
### Second Bin
bin_30 <- stud_grade %>% filter(Variable >= 20 & Variable < 30) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_30,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("20-30")
### Third Bin
bin_40 <- stud_grade %>% filter(Variable >= 30 & Variable < 40) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_40,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("30-40")
### Fourth Bin
bin_50 <- stud_grade %>% filter(Variable >= 40 & Variable < 50) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_50,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("40-50")
### Fifth Bin
bin_60 <- stud_grade %>% filter(Variable >= 50 & Variable < 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_60,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("50-60")
### Sixth Bin
bin_70 <- stud_grade %>% filter(Variable >= 60 & Variable < 70) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_70,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("60-70")
### Seventh Bin
bin_80 <- stud_grade %>% filter(Variable >= 70 & Variable < 80) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_80,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("70-80")
### Eighth Bin
bin_90 <- stud_grade %>% filter(Variable >= 80) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_90,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("80-90")
##### Ninth bin
bin_low <- stud_grade %>% filter(Variable < 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_low,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Bin_Low")
# Tenth bin
bin_top <- stud_grade %>% filter(Variable > 60) %>% select(SecondTier) %>% mutate(cou = 1) %>% group_by(SecondTier) %>% summarise(cou = sum(cou))
ggplot(data = bin_top,aes(SecondTier,cou,color=SecondTier)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Bin_Top")
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
stud_disc$cou <- 1
stud_disc_con <- stud_disc %>% group_by(ThirdTier) %>% summarise(Cou = sum(cou)) %>% arrange(desc(Cou))
ggplot(data = stud_disc_con,aes(ThirdTier,Cou)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Top Discipline Cases") + theme(axis.text.x = element_text(angle = 90))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normpop))
school_norm$Norm <- school_norm$Norm/sum(school_norm$Norm)
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)))
ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
View(Adl_Stud_timeline)
View(Desoto_New)
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
stud_disc$cou <- 1
stud_disc_con <- stud_disc %>% group_by(ThirdTier) %>% summarise(Cou = sum(cou)) %>% arrange(desc(Cou))
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
stud_disc$cou <- 1
stud_disc_con <- stud_disc %>% group_by(ThirdTier) %>% summarise(Cou = sum(cou)) %>% arrange(desc(Cou))
# Visualisation of the same
ggplot(data = stud_disc_con,aes(ThirdTier,Cou)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Top Discipline Cases") + theme(axis.text.x = element_text(angle = 90))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normpop))
school_norm$Norm <- school_norm$Norm/sum(school_norm$Norm)
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)))
ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
stud_disc$cou <- 1
stud_disc_con <- stud_disc %>% group_by(ThirdTier) %>% summarise(Cou = sum(cou)) %>% arrange(desc(Cou))
# Visualisation of the same
ggplot(data = stud_disc_con,aes(ThirdTier,Cou)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Top Discipline Cases") + theme(axis.text.x = element_text(angle = 90))
View(Discipline_template)
View(Discipline_Indicator_Master)
Disc_exp1 <- Desoto_New %>% filter(FirstTier == "Discipline")
View(Disc_exp1)
names(Discipline_template) <- c("FourthTier","Weight")
Disc_exp1 <- merge(Disc_exp1,Discipline_template,all.x = TRUE)
Disc_exp1$Wtdisc <- Disc_exp1$Weight/Disc_exp1$Population
Disc_agg <- Disc_exp1 %>% group_by(Schoolname) %>% summarise(sum(Wtdisc))
View(Disc_agg)
Disc_agg <- Disc_exp1 %>% group_by(Schoolname) %>% summarise(Wtdisc = sum(Wtdisc))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
View(school_disc)
Disc_exp1 <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop,FourthTier)
Disc_exp1 <- merge(Disc_exp1,Discipline_template,all.x = TRUE)
View(Disc_exp1)
Disc_exp1$Wtdisc <- Disc_exp1$Weight * Disc_exp1$Normpop # Normalising the discipline issues
View(Disc_exp1)
Disc_agg <- Disc_exp1 %>% group_by(Schoolname) %>% summarise(Wtdisc = sum(Wtdisc))
View(Disc_agg)
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
Disc_agg2 <- Disc_agg %>% filter(Schoolname != "JJAEP Dallas Co")
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
Disc_agg2 <- Disc_agg %>% filter(Schoolname != "JJAEP Dallas Co")
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg2,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
Disc_exp2 <- Desoto_New %>% filter(FirstTier == "Discipline")
View(Disc_exp2)
Disc_exp2 <- merge(Disc_exp2,Discipline_template,all.x = TRUE)
View(Disc_exp2)
1/805
Disc_exp2$Wtdisc <- Disc_exp2$Weight * Disc_exp2$Normvar
Disc_agg2 <- Disc_exp2 %>% group_by(Schoolname) %>% summarise(unwtdisc = sum(Normvar),Wtdisc = sum(Wtdisc))
View(Disc_agg2)
ggplot(data=Disc_agg2,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg2,aes(Schoolname,unwtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
Disc_exp1 <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop,FourthTier)
# Merging the weights of Discipline in this
Disc_exp1 <- merge(Disc_exp1,Discipline_template,all.x = TRUE)
Disc_exp1$Wtdisc <- Disc_exp1$Weight * Disc_exp1$Normpop # Normalising the discipline issues
# Aggregating the schools
Disc_agg <- Disc_exp1 %>% group_by(Schoolname) %>% summarise(Wtdisc = sum(Wtdisc))
####### Doing for all schools together
Disc_exp2 <- Desoto_New %>% filter(FirstTier == "Discipline")
Disc_exp2 <- merge(Disc_exp2,Discipline_template,all.x = TRUE)
Disc_exp2$Wtdisc <- Disc_exp2$Weight * Disc_exp2$Normvar
Disc_agg2 <- Disc_exp2 %>% group_by(Schoolname) %>% summarise(unwtdisc = sum(Normvar),Wtdisc = sum(Wtdisc))
Disc_exp1 <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normvar,FourthTier)
# Merging the weights of Discipline in this
Disc_exp1 <- merge(Disc_exp1,Discipline_template,all.x = TRUE)
Disc_exp1$Wtdisc <- Disc_exp1$Weight * Disc_exp1$Normvar # Normalising the discipline issues
# Aggregating the schools
Disc_agg <- Disc_exp1 %>% group_by(Schoolname) %>% summarise(Wtdisc = sum(Wtdisc))
####### Doing for all schools together
Disc_exp2 <- Desoto_New %>% filter(FirstTier == "Discipline")
Disc_exp2 <- merge(Disc_exp2,Discipline_template,all.x = TRUE)
Disc_exp2$Wtdisc <- Disc_exp2$Weight * Disc_exp2$Normvar
Disc_agg2 <- Disc_exp2 %>% group_by(Schoolname) %>% summarise(unwtdisc = sum(Normvar),Wtdisc = sum(Wtdisc))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
Disc_agg3 <- Disc_agg %>% filter(Schoolname != "JJAEP Dallas Co")
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg3,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
# Weighted School and unweighted school
ggplot(data=Disc_agg2,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg2,aes(Schoolname,unwtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normpop)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normvar))
school_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normvar)
school_norm <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(Normvar))
school_norm$Norm <- school_norm$Norm/sum(school_norm$Norm)
school_act <- school_disc %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)))
ggplot(data=school_act,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
View(school_disc)
View(school_norm)
1/3681
ggplot(data=school_norm,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
school_norm_2 <- school_norm %>% filter(Schoolname != "JJAEP Dallas Co" )
Disc_agg3 <- Disc_agg %>% filter(Schoolname != "JJAEP Dallas Co")
ggplot(data=school_norm_2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg3,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
# Weighted School and unweighted school
ggplot(data=Disc_agg2,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg2,aes(Schoolname,unwtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
View(Disc_exp2)
Disc_agg2 <- Disc_exp2 %>% group_by(Schoolname) %>% summarise(Norm = sum(Variable),unwtdisc = sum(Normvar),Wtdisc = sum(Wtdisc))
Disc_agg2 <- Disc_exp2 %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)),unwtdisc = sum(Normvar),Wtdisc = sum(Wtdisc))
View(Disc_agg2)
####### Doing for all schools together
Disc_exp2 <- Desoto_New %>% filter(FirstTier == "Discipline")
Disc_exp2 <- merge(Disc_exp2,Discipline_template,all.x = TRUE)
Disc_exp2$Wtdisc <- Disc_exp2$Weight * Disc_exp2$Normvar
Disc_agg2 <- Disc_exp2 %>% group_by(Schoolname) %>% summarise(Norm = sum(as.numeric(Variable)),unwtdisc = sum(Normvar),Wtdisc = sum(Wtdisc))
# Visualising the same
ggplot(data=Disc_agg2,aes(Schoolname,Norm,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg2,aes(Schoolname,unwtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
View(school_count)
View(school_name)
View(schoolname)
View(school_name)
View(school_count)
View(school_name)
View(school_count)
View(school_name)
View(school_count)
colnames(school_count)[1] <- colnames(school_name)[1]
school_name <- merge(school_name,school_count,all.x = TRUE)
View(school_name)
stud_disc <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(ThirdTier)
stud_disc$cou <- 1
stud_disc_con <- stud_disc %>% group_by(ThirdTier) %>% summarise(Cou = sum(cou)) %>% arrange(desc(Cou))
# Visualisation of the same
ggplot(data = stud_disc_con,aes(ThirdTier,Cou)) + geom_bar(stat = "identity", width = 0.2, position = "dodge") + ggtitle("Top Discipline Cases") + theme(axis.text.x = element_text(angle = 90))
Discipline_template
Disc_exp1 <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normvar,FourthTier)
# Merging the weights of Discipline in this
Disc_exp1 <- merge(Disc_exp1,Discipline_template,all.x = TRUE)
Disc_exp1$Wtdisc <- Disc_exp1$Weight * Disc_exp1$Normvar # Normalising the discipline issues
# Aggregating the schools
Disc_agg <- Disc_exp1 %>% group_by(Schoolname) %>% summarise(Wtdisc = sum(Wtdisc))
# Visualising the same
# Weighted School and unweighted school
ggplot(data=Disc_agg2,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg2,aes(Schoolname,unwtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
Disc_exp1 <- attend150_data %>% filter(StudentID %in% temp$StudentID) %>% filter(FirstTier=="Discipline") %>% select(Schoolname,Variable,Normvar,FourthTier)
# Merging the weights of Discipline in this
Disc_exp1 <- merge(Disc_exp1,Discipline_template,all.x = TRUE)
Disc_exp1$Wtdisc <- Disc_exp1$Weight * Disc_exp1$Normvar # Normalising the discipline issues
# Aggregating the schools
Disc_agg <- Disc_exp1 %>% group_by(Schoolname) %>% summarise(Wtdisc = sum(Wtdisc))
# Visualising the same
# Weighted School and unweighted school
ggplot(data=Disc_agg2,aes(Schoolname,unwtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
ggplot(data=Disc_agg2,aes(Schoolname,Wtdisc,color=Schoolname,group=1)) + geom_point() + geom_line()+ theme(axis.text.x=element_text(angle=70,hjust=1))
knit_with_parameters('C:/Customers/Edex/Desoto_R/Desoto_Notebook.Rmd')
